---
—Å–æ–∑–¥–∞–ª –∑–∞–º–µ—Ç–∫—É: 20-04-2025
tags:
  - –ü–ª—é—Å—ã
---
### –û–ø–∏—Å–∞–Ω–∏–µ
`volatile` —Å–æ–æ–±—â–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É:
> üí¨ ¬´**–≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç** –∏–∑–≤–Ω–µ ‚Äî –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π –µ–≥–æ —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å!¬ª
### –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?

–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤ –æ–±—ã—á–Ω–æ–º –∫–æ–¥–µ —Å—Ç–∞—Ä–∞–µ—Ç—Å—è **–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**:
```cpp
bool flag = some_global;
if (flag) { /* ... */ }
if (flag) { /* ... */ }  // ‚Üê –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–±—Ä–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
```
–ù–û! –ï—Å–ª–∏ `flag` –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω—ë–Ω, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- –¥—Ä—É–≥–∏–º **–ø–æ—Ç–æ–∫–æ–º**
- **–∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º** (—á–µ—Ä–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä—ã)
- **—Å–∏–≥–Ω–∞–ª–æ–º** –û–°
‚Ä¶—Ç–æ **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ**!
**–¢–æ–≥–¥–∞ –º—ã –æ–±—ä—è–≤–ª—è–µ–º:**
```cpp
volatile bool flag;
```
–ò –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä **–±—É–¥–µ—Ç –∑–∞–Ω–æ–≤–æ —á–∏—Ç–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∫–∞–∂–¥—ã–π —Ä–∞–∑**  
(–∏ –Ω–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –µ—ë –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ)
### –ü—Ä–∏–º–µ—Ä—ã, –≥–¥–µ `volatile` –Ω—É–∂–µ–Ω:
1. üö¶ –§–ª–∞–≥ –æ—Å—Ç–∞–Ω–æ–≤–∞ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º –∫–æ–¥–µ (–Ω–æ –Ω–µ –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–±!):
 ```cpp
volatile bool stop = false;

void worker() {
    while (!stop) {
        // —Ä–∞–±–æ—Ç–∞–µ–º
    }
}
```
–ù–æ! –î–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `std::atomic<bool>` ‚Äî `volatile` –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é!

2. üìü –†–∞–±–æ—Ç–∞ —Å **—Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤**:
```cpp
volatile uint8_t* hardware_reg = reinterpret_cast<volatile uint8_t*>(0xFFFF0000);
*hardware_reg = 0x1F; // –ü–∏—à–µ–º –Ω–∞–ø—Ä—è–º—É—é –≤ –∂–µ–ª–µ–∑–æ
```
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ "–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å" –∏–ª–∏ "–æ—Ç–ª–æ–∂–∏—Ç—å" –∑–∞–ø–∏—Å—å
- –≠—Ç–æ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ Embedded-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**

### –ß—Ç–æ `volatile` **–ù–ï –¥–µ–ª–∞–µ—Ç**:

|–ú–∏—Ñ|–ü—Ä–∞–≤–¥–∞|
|---|---|
|`volatile` –¥–µ–ª–∞–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ|‚ùå –ù–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π `std::atomic` –∏–ª–∏ `mutex`|
|`volatile` = –∑–∞—â–∏—Ç–∞ –æ—Ç –≥–æ–Ω–æ–∫|‚ùå –ù–µ—Ç. –û–Ω –ø—Ä–æ—Å—Ç–æ **–∑–∞–ø—Ä–µ—â–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**|
|`volatile` = –∑–∞—â–∏—Ç–∞ –æ—Ç reorder|‚ùå –ù–µ—Ç. –û–Ω **–Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫**|
### üìå –ì–¥–µ –æ–Ω **–Ω—É–∂–µ–Ω**?
|–°—Ü–µ–Ω–∞—Ä–∏–π|–ù—É–∂–µ–Ω `volatile`?|
|---|---|
|–†–µ–≥–∏—Å—Ç—Ä—ã –∂–µ–ª–µ–∑–∞, –ø–æ—Ä—Ç I/O|‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ|
|–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –º–µ–Ω—è–µ–º–∞—è ISR (—Å–∏–≥–Ω–∞–ª–æ–º)|‚úÖ –î–∞|
|–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å, —Ñ–ª–∞–≥–∏|‚ùå –õ—É—á—à–µ `atomic`|
|–û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã|‚ùå –ù–µ—Ç|
### –†–µ–∑—é–º–µ
**`volatile` ‚Äî —ç—Ç–æ –∑–∞–ø—Ä–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É –¥–µ–ª–∞—Ç—å ‚Äú—É–º–Ω—ã–µ‚Äù –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**  
**–¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è –±–µ–∑ –µ–≥–æ –≤–µ–¥–æ–º–∞**  
(—á–µ—Ä–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è, –∂–µ–ª–µ–∑–æ, –¥—Ä—É–≥–∏–µ –ø–æ—Ç–æ–∫–∏, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–∞–¥—ë