---
—Å–æ–∑–¥–∞–ª –∑–∞–º–µ—Ç–∫—É: 21-04-2025
tags:
  - –ü–ª—é—Å—ã
---
### –û–ø–∏—Å–∞–Ω–∏–µ
–í C++ **–æ–¥–Ω–∞ —Å—É—â–Ω–æ—Å—Ç—å** (—Ñ—É–Ω–∫—Ü–∏—è, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –∫–ª–∞—Å—Å –∏ —Ç.–¥.)  
**–º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö **–æ–¥–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (–∏–ª–∏ –µ–¥–∏–Ω–∏—Ü—ã —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏)**.
### –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ?
- –ö–ª–∞—Å—Å, —Ñ—É–Ω–∫—Ü–∏—è, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è **–¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**
- –ù–æ **–º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π**

–ü—Ä–∏–º–µ—Ä: –≤—Å—ë —Ö–æ—Ä–æ—à–æ (–æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
```cpp
// myheader.h
class MyClass {
public:
    void foo();
};
```
```cpp
// myclass.cpp
#include "myheader.h"

void MyClass::foo() {
    // —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
```
üîπ –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–∞—ë—Ç **–æ–±—ä—è–≤–ª–µ–Ω–∏–µ**, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî **–æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**

–ü—Ä–∏–º–µ—Ä: –Ω–∞—Ä—É—à–µ–Ω–∏–µ ODR
```cpp
// file1.cpp
int x = 42;

// file2.cpp
int x = 99;
```
–ï—Å–ª–∏ –æ–±–∞ —Ñ–∞–π–ª–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–µ, –ª–∏–Ω–∫–æ–≤—â–∏–∫ **–≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É**: `x` –æ–ø—Ä–µ–¥–µ–ª—ë–Ω **–¥–≤–∞–∂–¥—ã**.

### ODR –∫–∞—Å–∞–µ—Ç—Å—è:
|–°—É—â–Ω–æ—Å—Ç—å|–ü—Ä–∏–º–µ—Ä|
|---|---|
|–ö–ª–∞—Å—Å—ã / structs|`class Foo { ... };`|
|–§—É–Ω–∫—Ü–∏–∏|`void f() { ... }`|
|–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã|`const int x = 10;` (–±–µ–∑ `inline`)|
|–®–∞–±–ª–æ–Ω—ã|`template<class T> void f();`|
|Inline-—Ñ—É–Ω–∫—Ü–∏–∏|`inline void foo() {}`|
### –ì–¥–µ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ ODR?
- **–ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã** (`.h`)
- **–®–∞–±–ª–æ–Ω—ã** (–∏—Ö –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤ `.h`, –Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ)    
- **Inline —Ñ—É–Ω–∫—Ü–∏–∏ / constexpr** (—Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö) 
- **ODR-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** ‚Äî –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è/—Ä–∞–∑—ã–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è
### –ö–∞–∫ **–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** ODR?
- **–û–±—ã—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º `.cpp`
- **–®–∞–±–ª–æ–Ω—ã, `inline`, `constexpr`** ‚Äî –º–æ–∂–Ω–æ –≤ `.h`, –µ—Å–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤–æ –≤—Å–µ—Ö TU
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Äî —á–µ—Ä–µ–∑ `extern`:
```cpp
// header.h
extern int gValue;

// source.cpp
int gValue = 10;

```
### –†–µ–∑—é–º–µ
==> **ODR (One Definition Rule)** = "–æ–¥–Ω–∞ —Å—É—â–Ω–æ—Å—Ç—å ‚Üí –æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ"  
> –ò–Ω–∞—á–µ: ‚ùå –ª–∏–Ω–∫–æ–≤–∫–∞, ‚ùå UB, ‚ùå –Ω–æ—á–Ω—ã–µ –±–∞–≥–∏.

üìå –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –¥–µ—Ä–∂–∏—Ç **–≤—Å—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É C++ –Ω–∞ –ø–ª–∞–≤—É**, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å:
- –±–æ–ª—å—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏
- —Å–±–æ—Ä–∫–∞–º–∏ —Å `-O3` –∏–ª–∏ `LTO`